# NGINX

[toc]

## Отличия от Apache
 В первую очередь стоит понимать, что nginx - это не веб сервер, а обратный прокси сервер.
Если сравнивать с Apache то:
- по-умолчанию Apache работает в режиме prefork. Apache запускает определенное количество процессов , где каждый процесс обрабатывает 1 запрос за 1 единицу времени по порядку. В то же самое время Nginx в стандартной настройке обрабатывает несколько запросов одновременно (асинхронно).
- Дизайн Nginx не предполагает встраивания языков программирования в собственные процессы. Это значит что весь динамический контент необходимо передать данные в другой обработчик (например php-fpm)
- Ответ из обработчика приходит назад в Ngnix который в свою очеред отдает ответ клиенту.
- Nginx может отдавать статический контент без обращения к сторонним программам
- Apache поддерживает .htacess , чего не умеет nginx

## Терминология

### Контексты(Context)
в общем смысле - это разделы в файлах конфигурации
#### Основной контекст
Опции для master процессов
#### HTTP контекст
обработка HTTP
#### Server контекст
Эквивалент Apache vhost
#### Location контекст
Обработка обращений по определенному пути

### Директивы(Directives)
Конкретные опции конфигурации.
```nginx
<имя опции> <значение опции>;
```
## Пример настройки хоста
```nginx
# для примера примем, что файлы находятся в папке /var/www/site
# настройки nginx хранятся в папке  /etc/nginx/

# /etc/nginx/nginx.conf

events {}

http {
	server {
		
		listen 80; # директива указывает, какой порт будет прослушиваться
		server_name <name>; # директива указывает имя сервера
		root /var/www/site; # директива указывает где хранятся файлы сайта
		
		location = /greet {
		
		}
		
		location ^~ /greet {
		
		}
		
		location ~ /greet[0-9] {

		}
		
		location *~ /greet[0-9] {

		}
		
		location /greet {
		
		}
	}

}
```

## Основные команды NGINX

```bash
nginx -s # посылает серверу определенный сигнал
	 # stop - быстрое завершение
	 # quit - плавное завершение (graceful)
	 # reload - перезагрузка конфигурационного файла
	 # reopen -  переоткрытие лог-файлов

nginx -t # тест конфигурации без запуска nginx
```
Другие параметры можно узнать через 
```bash 
man nginx
```

